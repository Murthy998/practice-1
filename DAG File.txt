from airflow import DAG
from datetime import datetime,timedelta
from airflow.operators.bash_operator import BashOperator
from airflow.operators.python_operator import PythonOperator
from pre_processing import pre_process
from pre_process import process_data

default_args = {"owner":"sudheer",
"start_date":datetime(2023,5,30)}
with DAG(dag_id="yelleti",default_args=default_args,schedule_interval='****') as dag:

check_file = BashOperator{
task_id="0001",
bash_command="***file path***",
retries = 2,
retry_delay=timedelta(second=15)}

pre_process = PythonOperator{
 task_id="0002",
 python_callable = pre_process
}

agg = PythonOperator{
 task_id="0003",
 python_callable = process_data
}

create_table = MySqlOperator{
 task_id="0004",
 mysql_conn_id="mysql_db1",
 sql= "**file path***"
}

email = EmailOperator{
task_id="0005",
to='sudhheryelleti@gmai.com',
subject='Task is Done',
}